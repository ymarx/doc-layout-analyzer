# 📝 기술기준 문서 주석 편집 가이드

## 🎯 개요

이 시스템은 기술기준_예시.docx와 같은 문서의 인식율을 개선하기 위해 사용자가 직접 바운딩 박스, 항목 지정, 섹션 분할 등을 조정할 수 있는 기능을 제공합니다.

## 📊 현재 처리 결과 분석

### 기술기준_예시.docx 처리 현황:
- ✅ **문서 타입 인식**: "기술기준" 자동 감지
- ✅ **구조 파싱**: 10개 섹션 추출
- ✅ **다이어그램 감지**: 7개 다이어그램 발견
- ✅ **헤더 정보**: TP-030-030-050, 시행일, 페이지 정보 추출
- ⚠️ **개선 필요**: 바운딩 박스 정확도, 섹션 분할, 항목 분류

### 감지된 문서 양식 패턴:
```
📋 기술기준 표준 양식:
├── 헤더 영역: 문서번호(TP-030-030-050), 시행일, 페이지
├── 제목: "노황변동시 조치기준"
├── 작성자 정보: "진 다 훈"
├── 번호 매겨진 섹션:
│   ├── 1. 적용범위
│   ├── 2. 목적
│   ├── 3. 중점관리항목
│   └── 4. 조업기준 (하위 항목 포함)
├── 표/박스 형태 데이터
└── 다이어그램/플로우차트
```

## 🛠️ 사용자 조정 방법

### 1. 주석 편집기 실행

```bash
# 최근 처리된 문서 자동 로드
python annotation_editor.py

# 특정 문서 지정
python annotation_editor.py pipeline_output/문서ID.docjson
```

### 2. 바운딩 박스 조정

#### 2.1 새 필드 추가
```
📍 필드 추가 과정:
1. 메뉴에서 "3. 필드 추가" 선택
2. 필드 이름 입력 (예: "문서번호", "제목", "적용범위")
3. 필드 타입 선택:
   - text: 일반 텍스트
   - code: 기술코드 (TP-030-030-050)
   - title: 제목/헤딩
   - date: 날짜 정보
4. 바운딩 박스 좌표 입력: x1,y1,x2,y2,page
```

#### 2.2 기존 필드 편집
```
✏️ 바운딩 박스 수정:
- 현재 좌표 확인
- 새 좌표 입력 (x1,y1,x2,y2,page)
- 설명 업데이트
```

### 3. 자동 필드 제안 활용

```bash
🤖 시스템 자동 분석:
- TP-xxx-xxx-xxx 패턴 → 문서번호 필드
- 번호 매겨진 항목 (1., 2., 3.) → 섹션 필드
- 짧은 제목 텍스트 → 제목 필드
- 기술 키워드 포함 → 중요 내용 필드
```

## 📐 바운딩 박스 좌표 시스템

### 좌표 체계:
- **x1, y1**: 좌상단 모서리
- **x2, y2**: 우하단 모서리
- **page**: 페이지 번호 (1부터 시작)

### 실제 예시:
```
문서번호 "TP-030-030-050":
- 좌표: 400,50,600,80,1
- 의미: 1페이지의 (400,50)-(600,80) 영역

제목 "노황변동시 조치기준":
- 좌표: 200,100,500,130,1
- 의미: 1페이지의 (200,100)-(500,130) 영역
```

## 🎯 인식율 개선 전략

### 1. 핵심 영역 우선 정의
```
🔴 CRITICAL (반드시 정의):
- 문서번호 (TP-030-030-050)
- 문서제목 (노황변동시 조치기준)
- 시행일 ('25.07.28)
- 개정번호 (Rev. : 10)

🟡 HIGH (중요):
- 섹션 제목 (1. 적용범위, 2. 목적)
- 작성자 정보
- 중점관리항목 표

🟢 MEDIUM (일반):
- 상세 내용 텍스트
- 부가 설명
```

### 2. 문서 타입별 템플릿 생성

#### 기술기준 표준 템플릿:
```json
{
  "fields": [
    {
      "name": "문서번호",
      "type": "code",
      "importance": "critical",
      "pattern": "TP-\\d{3}-\\d{3}-\\d{3}"
    },
    {
      "name": "제목",
      "type": "title",
      "importance": "critical"
    },
    {
      "name": "적용범위",
      "type": "text",
      "importance": "high"
    }
  ]
}
```

### 3. 단계별 개선 과정

#### Phase 1: 기본 구조 정의
```bash
1. python annotation_editor.py
2. "5. 자동 필드 제안" 실행
3. 제안된 필드 검토 및 승인
4. "6. 주석 요약 내보내기"
```

#### Phase 2: 정밀 조정
```bash
1. "2. 현재 주석 보기"로 현재 상태 확인
2. "4. 필드 편집"으로 바운딩 박스 정밀 조정
3. 중요도 및 설명 업데이트
```

#### Phase 3: 검증 및 개선
```bash
1. 조정된 주석으로 문서 재처리
2. 인식율 비교 분석
3. 추가 필드 정의 및 조정
```

## 🔧 고급 기능

### 1. 커스텀 템플릿 생성
```bash
# 대화형 템플릿 생성
python enhanced_main.py --create-template

# 생성된 템플릿으로 처리
python enhanced_main.py document.docx --template template_id
```

### 2. 배치 처리 및 비교
```bash
# 여러 문서 일괄 처리
python enhanced_main.py docs/*.docx --complete

# 처리 통계 확인
python enhanced_main.py --stats
```

### 3. XML 중간 형식 활용
```bash
# XML 형식으로도 출력
python enhanced_main.py document.docx --xml

# XML에서 구조 분석 후 재조정
```

## 📈 성능 측정 및 개선

### 인식율 측정 지표:
- **필드 정확도**: 정의된 필드의 정확한 추출 비율
- **바운딩 박스 정확도**: 실제 위치 대비 예측 위치 오차
- **구조 분할 정확도**: 섹션 및 계층 구조 인식 정확도

### 개선 사이클:
```
📊 측정 → 📝 조정 → 🔄 재처리 → 📈 비교 → 🎯 개선
```

## 💡 활용 팁

### 1. 효율적인 필드 정의:
- 가장 중요한 정보부터 우선 정의
- 일관된 명명 규칙 사용
- 적절한 중요도 설정

### 2. 바운딩 박스 최적화:
- 여백을 최소화하되 텍스트 완전 포함
- 비슷한 타입의 요소는 유사한 크기로 설정
- 페이지 번호 정확히 확인

### 3. 반복 작업 자동화:
- 표준 템플릿 정의 후 재사용
- 배치 처리로 여러 문서 동시 개선
- 검증된 설정을 다른 문서에 적용

## 🚀 실제 사용 예시

### 기술기준_예시.docx 개선 시나리오:

1. **현재 상태 확인**:
   ```bash
   python annotation_editor.py
   # 메뉴 1: 문서 구조 보기
   ```

2. **자동 필드 제안 적용**:
   ```bash
   # 메뉴 5: 자동 필드 제안
   # 시스템이 감지한 TP-030-030-050, 제목 등 필드 확인
   ```

3. **수동 정밀 조정**:
   ```bash
   # 메뉴 3: 필드 추가
   # "중점관리항목_표" 필드 추가
   # 바운딩 박스: 실제 표 위치에 맞게 설정
   ```

4. **결과 확인 및 내보내기**:
   ```bash
   # 메뉴 6: 주석 요약 내보내기
   # 조정된 설정으로 문서 재처리
   ```

이렇게 단계적으로 조정하면 기술기준 문서의 인식율을 크게 개선할 수 있습니다.